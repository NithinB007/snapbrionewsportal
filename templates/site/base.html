{% load static %}
<!DOCTYPE html>
<html>
    {% include 'site/includes/_head.html' %}
        <title> 
             {% block title %}  {% endblock %} SNAPBRIO NEWS
        </title>
    </head>
<body id="page-top" data-spy="scroll" data-target=".navbar">
    <div id="main-wrapper">
        {% include 'site/includes/_header.html' with Category=Category %}
            {% block content %}{% endblock %}
        {% include 'site/includes/_mail_subscriptions.html' %}
        {% include 'site/includes/_footer.html' %}
        {% include 'site/includes/_uc_mobile_menu.html' %}
    </div>
        {% include 'site/includes/_scripts.html' %}
        {% include 'site/includes/_notification.html' %}
            {% block script %}{% endblock %}


            <!-- Share Modal -->
<div id="shareModal" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%);
background:#fff; border-radius:8px; padding:20px; z-index:1000; box-shadow:0 4px 20px rgba(0,0,0,0.3); width:300px;">
<h4>Share this article</h4>
<ul style="list-style:none; padding:0;">
    <li><a id="fb-share" href="#" target="_blank">Facebook</a></li>
    <li><a id="twitter-share" href="#" target="_blank">X (Twitter)</a></li>
    <li><a id="linkedin-share" href="#" target="_blank">LinkedIn</a></li>
    <li><a id="email-share" href="#">Email</a></li>
    <li><a href="#" onclick="copyToClipboard()">Copy Link</a></li>
</ul>
<button onclick="closeShareModal()" style="margin-top:10px;">Close</button>
</div>

<!-- Modal background overlay -->
<div id="modalOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
background:rgba(0,0,0,0.5); z-index:999;" onclick="closeShareModal()"></div>

</body>

<script>
    let currentArticleUrl = '';
    let currentArticleTitle = '';

    // Define your base URL here. This will be prepended to relative paths.
    const BASE_URL = "https://snapbrionews.onrender.com"; 
    
    function openShareModal(url, title) {
        // Prepend the base URL to the relative URL received from Django
        currentArticleUrl = BASE_URL + url; 
        currentArticleTitle = title;
    
        // Update the share links using the now complete 'currentArticleUrl'
        document.getElementById("fb-share").href = `https://www.facebook.com/sharer/sharer.php?u=${currentArticleUrl}`;
        document.getElementById("twitter-share").href = `https://twitter.com/intent/tweet?url=${currentArticleUrl}&text=${currentArticleTitle}`;
        document.getElementById("linkedin-share").href = `https://www.linkedin.com/shareArticle?url=${currentArticleUrl}&title=${currentArticleTitle}`;
        document.getElementById("email-share").href = `mailto:?subject=${currentArticleTitle}&body=${currentArticleUrl}`;
    
        document.getElementById("shareModal").style.display = "block";
        document.getElementById("modalOverlay").style.display = "block";
    }
    
    function closeShareModal() {
        document.getElementById("shareModal").style.display = "none";
        document.getElementById("modalOverlay").style.display = "none";
    }
    
    function copyToClipboard() {
        // Use the already constructed currentArticleUrl for copying
        document.execCommand('copy').then(function () { // Using document.execCommand for broader iframe compatibility
            // Instead of alert, use a simple message box or visual feedback
            const messageBox = document.createElement('div');
            messageBox.textContent = 'Link copied to clipboard!';
            messageBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #4CAF50;
                color: white;
                padding: 15px;
                border-radius: 8px;
                z-index: 10000;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                font-family: 'Inter', sans-serif;
                font-size: 16px;
            `;
            document.body.appendChild(messageBox);
            setTimeout(() => {
                document.body.removeChild(messageBox);
            }, 2000); // Remove after 2 seconds
        }).catch(function (err) {
            const messageBox = document.createElement('div');
            messageBox.textContent = 'Failed to copy the link. Please copy manually.';
            messageBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #f44336;
                color: white;
                padding: 15px;
                border-radius: 8px;
                z-index: 10000;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                font-family: 'Inter', sans-serif;
                font-size: 16px;
            `;
            document.body.appendChild(messageBox);
            setTimeout(() => {
                document.body.removeChild(messageBox);
            }, 3000); // Remove after 3 seconds
            console.error('Could not copy text: ', err);
        });
    }
</script>
    
</html>
